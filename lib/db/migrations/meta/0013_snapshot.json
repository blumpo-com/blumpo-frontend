{
  "id": "227b0a97-61af-4b30-b5cc-42287649eaf1",
  "prevId": "d8b181b0-2cc2-4620-8d6f-c8807bd2329e",
  "version": "7",
  "dialect": "postgresql",
  "tables": {
    "public.ad_archetype": {
      "name": "ad_archetype",
      "schema": "",
      "columns": {
        "code": {
          "name": "code",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "display_name": {
          "name": "display_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.ad_clone": {
      "name": "ad_clone",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "workflow_id": {
          "name": "workflow_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "storage_key": {
          "name": "storage_key",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "storage_url": {
          "name": "storage_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "ad_clone_workflow_id_unique": {
          "name": "ad_clone_workflow_id_unique",
          "columns": [
            {
              "expression": "workflow_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "ad_clone_workflow_id_ad_workflow_id_fk": {
          "name": "ad_clone_workflow_id_ad_workflow_id_fk",
          "tableFrom": "ad_clone",
          "tableTo": "ad_workflow",
          "columnsFrom": [
            "workflow_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.ad_event": {
      "name": "ad_event",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "bigserial",
          "primaryKey": true,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "brand_id": {
          "name": "brand_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "job_id": {
          "name": "job_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "ad_image_id": {
          "name": "ad_image_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "archetype_code": {
          "name": "archetype_code",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "workflow_id": {
          "name": "workflow_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "event_type": {
          "name": "event_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "event_source": {
          "name": "event_source",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        }
      },
      "indexes": {
        "idx_ad_event_ad_image": {
          "name": "idx_ad_event_ad_image",
          "columns": [
            {
              "expression": "ad_image_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_ad_event_job": {
          "name": "idx_ad_event_job",
          "columns": [
            {
              "expression": "job_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_ad_event_brand": {
          "name": "idx_ad_event_brand",
          "columns": [
            {
              "expression": "brand_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_ad_event_user": {
          "name": "idx_ad_event_user",
          "columns": [
            {
              "expression": "user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_ad_event_type_time": {
          "name": "idx_ad_event_type_time",
          "columns": [
            {
              "expression": "event_type",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "created_at",
              "isExpression": false,
              "asc": false,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "ad_event_user_id_user_id_fk": {
          "name": "ad_event_user_id_user_id_fk",
          "tableFrom": "ad_event",
          "tableTo": "user",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "ad_event_brand_id_brand_id_fk": {
          "name": "ad_event_brand_id_brand_id_fk",
          "tableFrom": "ad_event",
          "tableTo": "brand",
          "columnsFrom": [
            "brand_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "ad_event_job_id_generation_job_id_fk": {
          "name": "ad_event_job_id_generation_job_id_fk",
          "tableFrom": "ad_event",
          "tableTo": "generation_job",
          "columnsFrom": [
            "job_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "ad_event_ad_image_id_ad_image_id_fk": {
          "name": "ad_event_ad_image_id_ad_image_id_fk",
          "tableFrom": "ad_event",
          "tableTo": "ad_image",
          "columnsFrom": [
            "ad_image_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "ad_event_archetype_code_ad_archetype_code_fk": {
          "name": "ad_event_archetype_code_ad_archetype_code_fk",
          "tableFrom": "ad_event",
          "tableTo": "ad_archetype",
          "columnsFrom": [
            "archetype_code"
          ],
          "columnsTo": [
            "code"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "ad_event_workflow_id_ad_workflow_id_fk": {
          "name": "ad_event_workflow_id_ad_workflow_id_fk",
          "tableFrom": "ad_event",
          "tableTo": "ad_workflow",
          "columnsFrom": [
            "workflow_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.ad_image": {
      "name": "ad_image",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "job_id": {
          "name": "job_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "brand_id": {
          "name": "brand_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "title": {
          "name": "title",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "storage_key": {
          "name": "storage_key",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "public_url": {
          "name": "public_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "bytes_size": {
          "name": "bytes_size",
          "type": "bigint",
          "primaryKey": false,
          "notNull": true
        },
        "width": {
          "name": "width",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "height": {
          "name": "height",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "format": {
          "name": "format",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "workflow_id": {
          "name": "workflow_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "ban_flag": {
          "name": "ban_flag",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "error_flag": {
          "name": "error_flag",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "is_deleted": {
          "name": "is_deleted",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "delete_at": {
          "name": "delete_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "ready_to_display": {
          "name": "ready_to_display",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        }
      },
      "indexes": {
        "idx_ad_image_user_time": {
          "name": "idx_ad_image_user_time",
          "columns": [
            {
              "expression": "user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "created_at",
              "isExpression": false,
              "asc": false,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_ad_image_job": {
          "name": "idx_ad_image_job",
          "columns": [
            {
              "expression": "job_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_ad_image_brand": {
          "name": "idx_ad_image_brand",
          "columns": [
            {
              "expression": "brand_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_ad_image_workflow": {
          "name": "idx_ad_image_workflow",
          "columns": [
            {
              "expression": "workflow_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "ad_image_job_id_generation_job_id_fk": {
          "name": "ad_image_job_id_generation_job_id_fk",
          "tableFrom": "ad_image",
          "tableTo": "generation_job",
          "columnsFrom": [
            "job_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "ad_image_user_id_user_id_fk": {
          "name": "ad_image_user_id_user_id_fk",
          "tableFrom": "ad_image",
          "tableTo": "user",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "ad_image_brand_id_brand_id_fk": {
          "name": "ad_image_brand_id_brand_id_fk",
          "tableFrom": "ad_image",
          "tableTo": "brand",
          "columnsFrom": [
            "brand_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "ad_image_workflow_id_ad_workflow_id_fk": {
          "name": "ad_image_workflow_id_ad_workflow_id_fk",
          "tableFrom": "ad_image",
          "tableTo": "ad_workflow",
          "columnsFrom": [
            "workflow_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.ad_workflow": {
      "name": "ad_workflow",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "archetype_code": {
          "name": "archetype_code",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "workflow_uid": {
          "name": "workflow_uid",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "variant_key": {
          "name": "variant_key",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "format": {
          "name": "format",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_ad_workflow_archetype": {
          "name": "idx_ad_workflow_archetype",
          "columns": [
            {
              "expression": "archetype_code",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_ad_workflow_uid": {
          "name": "idx_ad_workflow_uid",
          "columns": [
            {
              "expression": "workflow_uid",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "ad_workflow_unique_variant": {
          "name": "ad_workflow_unique_variant",
          "columns": [
            {
              "expression": "archetype_code",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "variant_key",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "ad_workflow_archetype_code_ad_archetype_code_fk": {
          "name": "ad_workflow_archetype_code_ad_archetype_code_fk",
          "tableFrom": "ad_workflow",
          "tableTo": "ad_archetype",
          "columnsFrom": [
            "archetype_code"
          ],
          "columnsTo": [
            "code"
          ],
          "onDelete": "restrict",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "ad_workflow_workflow_uid_unique": {
          "name": "ad_workflow_workflow_uid_unique",
          "nullsNotDistinct": false,
          "columns": [
            "workflow_uid"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.auth_otp": {
      "name": "auth_otp",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true
        },
        "email": {
          "name": "email",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "code_hash": {
          "name": "code_hash",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "purpose": {
          "name": "purpose",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'LOGIN'"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true
        },
        "consumed_at": {
          "name": "consumed_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "attempts": {
          "name": "attempts",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "max_attempts": {
          "name": "max_attempts",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 5
        },
        "resend_count": {
          "name": "resend_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "ip_address": {
          "name": "ip_address",
          "type": "inet",
          "primaryKey": false,
          "notNull": false
        },
        "user_agent": {
          "name": "user_agent",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "idx_auth_otp_email_active": {
          "name": "idx_auth_otp_email_active",
          "columns": [
            {
              "expression": "email",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "where": "consumed_at IS NULL",
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "auth_otp_user_id_user_id_fk": {
          "name": "auth_otp_user_id_user_id_fk",
          "tableFrom": "auth_otp",
          "tableTo": "user",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.brand": {
      "name": "brand",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "is_deleted": {
          "name": "is_deleted",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "website_url": {
          "name": "website_url",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "language": {
          "name": "language",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'en'"
        },
        "fonts": {
          "name": "fonts",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'[]'::jsonb"
        },
        "colors": {
          "name": "colors",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true
        },
        "photos": {
          "name": "photos",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true
        },
        "hero_photos": {
          "name": "hero_photos",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true
        },
        "logo_url": {
          "name": "logo_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "website_data_url": {
          "name": "website_data_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "idx_brand_user": {
          "name": "idx_brand_user",
          "columns": [
            {
              "expression": "user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "brand_user_website_unique": {
          "name": "brand_user_website_unique",
          "columns": [
            {
              "expression": "user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "website_url",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "brand_user_id_user_id_fk": {
          "name": "brand_user_id_user_id_fk",
          "tableFrom": "brand",
          "tableTo": "user",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.brand_extraction_status": {
      "name": "brand_extraction_status",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "brand_id": {
          "name": "brand_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "colors_status": {
          "name": "colors_status",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'pending'"
        },
        "colors_error": {
          "name": "colors_error",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "fonts_status": {
          "name": "fonts_status",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'pending'"
        },
        "fonts_error": {
          "name": "fonts_error",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "logo_status": {
          "name": "logo_status",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'pending'"
        },
        "logo_error": {
          "name": "logo_error",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "hero_status": {
          "name": "hero_status",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'pending'"
        },
        "hero_error": {
          "name": "hero_error",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "insights_status": {
          "name": "insights_status",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'pending'"
        },
        "insights_error": {
          "name": "insights_error",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "brand_extraction_status_brand_id_unique": {
          "name": "brand_extraction_status_brand_id_unique",
          "columns": [
            {
              "expression": "brand_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "brand_extraction_status_brand_id_brand_id_fk": {
          "name": "brand_extraction_status_brand_id_brand_id_fk",
          "tableFrom": "brand_extraction_status",
          "tableTo": "brand",
          "columnsFrom": [
            "brand_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.brand_insights": {
      "name": "brand_insights",
      "schema": "",
      "columns": {
        "brand_id": {
          "name": "brand_id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "client_ad_preferences": {
          "name": "client_ad_preferences",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        },
        "industry": {
          "name": "industry",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "customer_pain_points": {
          "name": "customer_pain_points",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'"
        },
        "product_description": {
          "name": "product_description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "key_features": {
          "name": "key_features",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'"
        },
        "brand_voice": {
          "name": "brand_voice",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "unique_value_prop": {
          "name": "unique_value_prop",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "key_benefits": {
          "name": "key_benefits",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'"
        },
        "competitors": {
          "name": "competitors",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'"
        },
        "ins_trigger_events": {
          "name": "ins_trigger_events",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'"
        },
        "ins_aspirations": {
          "name": "ins_aspirations",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'"
        },
        "ins_marketing_insight": {
          "name": "ins_marketing_insight",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "ins_trend_opportunity": {
          "name": "ins_trend_opportunity",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "ins_raw": {
          "name": "ins_raw",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'[]'::jsonb"
        },
        "marketing_brief": {
          "name": "marketing_brief",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "reddit_customer_desires": {
          "name": "reddit_customer_desires",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::jsonb"
        },
        "reddit_customer_pain_points": {
          "name": "reddit_customer_pain_points",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::jsonb"
        },
        "reddit_interesting_quotes": {
          "name": "reddit_interesting_quotes",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::jsonb"
        },
        "reddit_purchase_triggers": {
          "name": "reddit_purchase_triggers",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::jsonb"
        },
        "reddit_marketing_brief": {
          "name": "reddit_marketing_brief",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "target_customers": {
          "name": "target_customers",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'"
        },
        "solution": {
          "name": "solution",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "website_text": {
          "name": "website_text",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {
        "brand_insights_brand_id_brand_id_fk": {
          "name": "brand_insights_brand_id_brand_id_fk",
          "tableFrom": "brand_insights",
          "tableTo": "brand",
          "columnsFrom": [
            "brand_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.generation_job": {
      "name": "generation_job",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "started_at": {
          "name": "started_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "completed_at": {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "viewed_at": {
          "name": "viewed_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "job_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'QUEUED'"
        },
        "prompt": {
          "name": "prompt",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "params": {
          "name": "params",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        },
        "tokens_cost": {
          "name": "tokens_cost",
          "type": "bigint",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "ledger_id": {
          "name": "ledger_id",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        },
        "error_code": {
          "name": "error_code",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "brand_id": {
          "name": "brand_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "product_photo_urls": {
          "name": "product_photo_urls",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'"
        },
        "product_photo_mode": {
          "name": "product_photo_mode",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'brand'"
        },
        "archetype_code": {
          "name": "archetype_code",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "archetype_mode": {
          "name": "archetype_mode",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'single'"
        },
        "formats": {
          "name": "formats",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'"
        },
        "selected_insights": {
          "name": "selected_insights",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'"
        },
        "insight_source": {
          "name": "insight_source",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'auto'"
        },
        "promotion_value_insight": {
          "name": "promotion_value_insight",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        },
        "archetype_inputs": {
          "name": "archetype_inputs",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        },
        "auto_generated": {
          "name": "auto_generated",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "workflow_ctx": {
          "name": "workflow_ctx",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        }
      },
      "indexes": {
        "idx_generation_job_user_time": {
          "name": "idx_generation_job_user_time",
          "columns": [
            {
              "expression": "user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "created_at",
              "isExpression": false,
              "asc": false,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_generation_job_status": {
          "name": "idx_generation_job_status",
          "columns": [
            {
              "expression": "status",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_generation_job_workflow_code": {
          "name": "idx_generation_job_workflow_code",
          "columns": [
            {
              "expression": "(\"workflow_ctx\"->>'workflow_code')",
              "asc": true,
              "isExpression": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_generation_job_execution_id": {
          "name": "idx_generation_job_execution_id",
          "columns": [
            {
              "expression": "((\"workflow_ctx\"->>'execution_id')::bigint)",
              "asc": true,
              "isExpression": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "generation_job_user_id_user_id_fk": {
          "name": "generation_job_user_id_user_id_fk",
          "tableFrom": "generation_job",
          "tableTo": "user",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "generation_job_ledger_id_token_ledger_id_fk": {
          "name": "generation_job_ledger_id_token_ledger_id_fk",
          "tableFrom": "generation_job",
          "tableTo": "token_ledger",
          "columnsFrom": [
            "ledger_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "generation_job_brand_id_brand_id_fk": {
          "name": "generation_job_brand_id_brand_id_fk",
          "tableFrom": "generation_job",
          "tableTo": "brand",
          "columnsFrom": [
            "brand_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "generation_job_archetype_code_ad_archetype_code_fk": {
          "name": "generation_job_archetype_code_ad_archetype_code_fk",
          "tableFrom": "generation_job",
          "tableTo": "ad_archetype",
          "columnsFrom": [
            "archetype_code"
          ],
          "columnsTo": [
            "code"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "generation_job_ledger_id_unique": {
          "name": "generation_job_ledger_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "ledger_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.generation_pricing": {
      "name": "generation_pricing",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "bigserial",
          "primaryKey": true,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "strategy": {
          "name": "strategy",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'STATIC'"
        },
        "base_cost_tokens": {
          "name": "base_cost_tokens",
          "type": "bigint",
          "primaryKey": false,
          "notNull": true
        },
        "rules": {
          "name": "rules",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'"
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "version": {
          "name": "version",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 1
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "uq_generation_pricing_single_active": {
          "name": "uq_generation_pricing_single_active",
          "columns": [
            {
              "expression": "is_active",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "where": "is_active = true",
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.n8n_workflow_error_occurrences": {
      "name": "n8n_workflow_error_occurrences",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "bigserial",
          "primaryKey": true,
          "notNull": true
        },
        "error_id": {
          "name": "error_id",
          "type": "bigint",
          "primaryKey": false,
          "notNull": true
        },
        "occurred_at": {
          "name": "occurred_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true
        },
        "execution_id": {
          "name": "execution_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "execution_url": {
          "name": "execution_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "mode": {
          "name": "mode",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "source": {
          "name": "source",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "stack": {
          "name": "stack",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_n8n_workflow_error_occurrences_error_time": {
          "name": "idx_n8n_workflow_error_occurrences_error_time",
          "columns": [
            {
              "expression": "error_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "occurred_at",
              "isExpression": false,
              "asc": false,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_n8n_workflow_error_occurrences_occurred_at": {
          "name": "idx_n8n_workflow_error_occurrences_occurred_at",
          "columns": [
            {
              "expression": "occurred_at",
              "isExpression": false,
              "asc": false,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "n8n_workflow_error_occurrences_error_id_n8n_workflow_errors_id_fk": {
          "name": "n8n_workflow_error_occurrences_error_id_n8n_workflow_errors_id_fk",
          "tableFrom": "n8n_workflow_error_occurrences",
          "tableTo": "n8n_workflow_errors",
          "columnsFrom": [
            "error_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.n8n_workflow_errors": {
      "name": "n8n_workflow_errors",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "bigserial",
          "primaryKey": true,
          "notNull": true
        },
        "workflow_id": {
          "name": "workflow_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "workflow_name": {
          "name": "workflow_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "node_id": {
          "name": "node_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "node_name": {
          "name": "node_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "node_type": {
          "name": "node_type",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "node_type_version": {
          "name": "node_type_version",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "error_name": {
          "name": "error_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "error_level": {
          "name": "error_level",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "error_fingerprint": {
          "name": "error_fingerprint",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "occurrences_count": {
          "name": "occurrences_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 1
        },
        "first_seen_at": {
          "name": "first_seen_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true
        },
        "last_seen_at": {
          "name": "last_seen_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true
        },
        "last_execution_id": {
          "name": "last_execution_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "last_execution_url": {
          "name": "last_execution_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "last_node_executed": {
          "name": "last_node_executed",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "sample_stack": {
          "name": "sample_stack",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "is_resolved": {
          "name": "is_resolved",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "resolved_at": {
          "name": "resolved_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "resolved_by": {
          "name": "resolved_by",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "resolution_note": {
          "name": "resolution_note",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_n8n_workflow_errors_workflow_id": {
          "name": "idx_n8n_workflow_errors_workflow_id",
          "columns": [
            {
              "expression": "workflow_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_n8n_workflow_errors_node_id": {
          "name": "idx_n8n_workflow_errors_node_id",
          "columns": [
            {
              "expression": "node_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_n8n_workflow_errors_resolved_time": {
          "name": "idx_n8n_workflow_errors_resolved_time",
          "columns": [
            {
              "expression": "is_resolved",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "last_seen_at",
              "isExpression": false,
              "asc": false,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_n8n_workflow_errors_level_time": {
          "name": "idx_n8n_workflow_errors_level_time",
          "columns": [
            {
              "expression": "error_level",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "last_seen_at",
              "isExpression": false,
              "asc": false,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "uq_n8n_workflow_errors_fingerprint": {
          "name": "uq_n8n_workflow_errors_fingerprint",
          "nullsNotDistinct": false,
          "columns": [
            "error_fingerprint"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.subscription_plan": {
      "name": "subscription_plan",
      "schema": "",
      "columns": {
        "plan_code": {
          "name": "plan_code",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "display_name": {
          "name": "display_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "monthly_tokens": {
          "name": "monthly_tokens",
          "type": "bigint",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "stripe_product_id": {
          "name": "stripe_product_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "is_default": {
          "name": "is_default",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "sort_order": {
          "name": "sort_order",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 100
        },
        "rollover_cap": {
          "name": "rollover_cap",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "uq_subscription_plan_single_default": {
          "name": "uq_subscription_plan_single_default",
          "columns": [
            {
              "expression": "is_default",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "where": "is_default = true",
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_subscription_plan_active_sort": {
          "name": "idx_subscription_plan_active_sort",
          "columns": [
            {
              "expression": "is_active",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "sort_order",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "subscription_plan_stripe_product_id_unique": {
          "name": "subscription_plan_stripe_product_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "stripe_product_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.token_account": {
      "name": "token_account",
      "schema": "",
      "columns": {
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true
        },
        "balance": {
          "name": "balance",
          "type": "bigint",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "plan_code": {
          "name": "plan_code",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'FREE'"
        },
        "period": {
          "name": "period",
          "type": "subscription_period",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'MONTHLY'"
        },
        "last_refill_at": {
          "name": "last_refill_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "next_refill_at": {
          "name": "next_refill_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "stripe_customer_id": {
          "name": "stripe_customer_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "stripe_subscription_id": {
          "name": "stripe_subscription_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "stripe_product_id": {
          "name": "stripe_product_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "stripe_price_id": {
          "name": "stripe_price_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "subscription_status": {
          "name": "subscription_status",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "cancellation_time": {
          "name": "cancellation_time",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "cancellation_reasons": {
          "name": "cancellation_reasons",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "retention_offer_applied_at": {
          "name": "retention_offer_applied_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "retention_discount_renewal_at": {
          "name": "retention_discount_renewal_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "uq_token_account_stripe_customer": {
          "name": "uq_token_account_stripe_customer",
          "columns": [
            {
              "expression": "stripe_customer_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "where": "stripe_customer_id IS NOT NULL",
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "uq_token_account_stripe_subscription": {
          "name": "uq_token_account_stripe_subscription",
          "columns": [
            {
              "expression": "stripe_subscription_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "where": "stripe_subscription_id IS NOT NULL",
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "token_account_user_id_user_id_fk": {
          "name": "token_account_user_id_user_id_fk",
          "tableFrom": "token_account",
          "tableTo": "user",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "token_account_plan_code_subscription_plan_plan_code_fk": {
          "name": "token_account_plan_code_subscription_plan_plan_code_fk",
          "tableFrom": "token_account",
          "tableTo": "subscription_plan",
          "columnsFrom": [
            "plan_code"
          ],
          "columnsTo": [
            "plan_code"
          ],
          "onDelete": "restrict",
          "onUpdate": "cascade"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.token_ledger": {
      "name": "token_ledger",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "bigserial",
          "primaryKey": true,
          "notNull": true
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "occurred_at": {
          "name": "occurred_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "delta": {
          "name": "delta",
          "type": "bigint",
          "primaryKey": false,
          "notNull": true
        },
        "reason": {
          "name": "reason",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "reference_id": {
          "name": "reference_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "balance_after": {
          "name": "balance_after",
          "type": "bigint",
          "primaryKey": false,
          "notNull": true
        }
      },
      "indexes": {
        "idx_token_ledger_user_time": {
          "name": "idx_token_ledger_user_time",
          "columns": [
            {
              "expression": "user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "occurred_at",
              "isExpression": false,
              "asc": false,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "uq_token_ledger_reason_ref": {
          "name": "uq_token_ledger_reason_ref",
          "columns": [
            {
              "expression": "reason",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "reference_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "where": "reference_id IS NOT NULL",
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "token_ledger_user_id_user_id_fk": {
          "name": "token_ledger_user_id_user_id_fk",
          "tableFrom": "token_ledger",
          "tableTo": "user",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.topup_plan": {
      "name": "topup_plan",
      "schema": "",
      "columns": {
        "topup_sku": {
          "name": "topup_sku",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "display_name": {
          "name": "display_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "tokens_amount": {
          "name": "tokens_amount",
          "type": "bigint",
          "primaryKey": false,
          "notNull": true
        },
        "stripe_product_id": {
          "name": "stripe_product_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "sort_order": {
          "name": "sort_order",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 100
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_topup_plan_active_sort": {
          "name": "idx_topup_plan_active_sort",
          "columns": [
            {
              "expression": "is_active",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "sort_order",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "topup_plan_stripe_product_id_unique": {
          "name": "topup_plan_stripe_product_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "stripe_product_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.user": {
      "name": "user",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true
        },
        "email": {
          "name": "email",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "display_name": {
          "name": "display_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "photo_url": {
          "name": "photo_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "phone_number": {
          "name": "phone_number",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "last_login_at": {
          "name": "last_login_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "ban_flag": {
          "name": "ban_flag",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "role": {
          "name": "role",
          "type": "user_role",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'USER'"
        }
      },
      "indexes": {
        "user_role_idx": {
          "name": "user_role_idx",
          "columns": [
            {
              "expression": "role",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "user_email_unique": {
          "name": "user_email_unique",
          "nullsNotDistinct": false,
          "columns": [
            "email"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    }
  },
  "enums": {
    "public.job_status": {
      "name": "job_status",
      "schema": "public",
      "values": [
        "QUEUED",
        "RUNNING",
        "SUCCEEDED",
        "FAILED",
        "CANCELED"
      ]
    },
    "public.subscription_period": {
      "name": "subscription_period",
      "schema": "public",
      "values": [
        "MONTHLY",
        "YEARLY"
      ]
    },
    "public.user_role": {
      "name": "user_role",
      "schema": "public",
      "values": [
        "USER",
        "ADMIN"
      ]
    }
  },
  "schemas": {},
  "sequences": {},
  "roles": {},
  "policies": {},
  "views": {},
  "_meta": {
    "columns": {},
    "schemas": {},
    "tables": {}
  }
}